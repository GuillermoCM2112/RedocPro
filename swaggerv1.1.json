{
  "openapi": "3.0.1",
  "info": {
    "title": "Redopro - v1.1",
    "description": "# RedocPro\r\n\r\nImplementación del servicio Customer Identity and Access Management (CIAM)  \r\n <!---![Alt text](image.png)-->\r\n\r\n## Endpoints\r\n\r\nHasta el momento, se cuentan con los siguientes endpoints:\r\n- `Login`: \r\n- `Signup`:\r\n- `RefreshToken`: \r\n- `ChangeUserPassword`: \r\n- `ChangeUserProperty`: \r\n- `UserValidation`: \r\n- `RevokeRefreshToken`:\r\n\r\nPara descargar la colección de Postman puede hacer <a href=\"postman_collection.json\" download>click aquí</a>\r\n\r\n\r\n\r\nPara descargar las variables de entorno de Postman puede hacer <a href=\"test_environment.json\" download>click aquí</a>\r\n\r\n## Ejecución local\r\nPara ejecutar de forma local, se pueden seguir los siguientes pasos:\r\n1. Instalar la versión más reciente de Visual Studio.\r\n2. Descargar el `.zip` de la rama `main` del repositorio.\r\n3. Abrir el proyecto\r\n4. Instalar las depencias de Node con ```npm install```\r\n5. Agregar en el [`appsettings.Development.json`]\r\n6. Ahora, puedes hacer click en la ejecutar el proyecto, o bien, en \"Depurar > Iniciar depuración\".\r\n\r\nDonde puedes interactuar con los endpoints de CIAM. Si no se abre la ventana, puedes ingresar a esta por medio del siguiente enlace: [https://localhost:7131/swagger).\r\n\r\n## Como contribuir al repositorio\r\nPara contribuir al repositorio se te deben otorgar permisos de escritura y seguir los siguientes pasos. \r\n\r\n1. Asociar un nuevo SSH con tu cuenta de GitHub institucional.\r\n\r\n    En esta ocasión, no basta con descargar el `.zip` del repositorio. Debes configurar tu dispositivo para conectar tu cuenta de GitHub mediante SSH, puedes seguir el siguiente [tutorial de GitHub](https://docs.github.com/en/authentication/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account) para añadir una SSH a tu cuenta. Además, debes darle permisos para acceder a `digitaltitransversal`, sigue el siguiente [tutorial](https://docs.github.com/en/enterprise-cloud@latest/authentication/authenticating-with-saml-single-sign-on/authorizing-an-ssh-key-for-use-with-saml-single-sign-on) para dar dichos permisos.\r\n\r\n2. Teniendo ya el SSH configurado, debes clonar el repositorio en la carpeta de tu preferencia. Como sugerencia, puedes crear una carpeta `~/Projects` para mantener todos los proyectos en un sólo lugar.\r\n\r\n    En la terminal, corre el siguiente comando:\r\n    ```\r\n    git clone git@github.com:\r\n    ```\r\n\r\n    Debería aparecer una salida parecida a:\r\n    ```\r\n    remote: Enumerating objects: 542, done.\r\n    remote: Counting objects: 100% (314/314), done.\r\n    remote: Compressing objects: 100% (177/177), done.\r\n    remote: Total 542 (delta 196), reused 178 (delta 122), pack-reused 228\r\n    Receiving objects: 100% (542/542), 110.60 KiB | 1.44 MiB/s, done.\r\n    Resolving deltas: 100% (271/271), done.\r\n    ```\r\n\r\n3. En este punto, se pueden seguir los pasos que se describieron para la ejecución local.\r\n\r\n4. Si se quiere agregar nuevos cambios, debes crear tu propia rama.\r\n    ```\r\n    git branch rama-de-ejemplo\r\n    ```\r\n\r\n5. Para empezar a trabajar sobre la rama creada, puedes ejecutar el siguiente comando:\r\n\r\n    ```\r\n    git checkout rama-de-ejemplo\r\n    ```\r\n\r\n    En este punto ya puedes comenzar a hacer tus cambios. Si no haces el `checkout` a tu rama, puede que afectes a otras ramas e interrumpir el trabajo de los demás. Recuerda que no te dejará hacer `push` a `main`. \r\n\r\n6. Después de hacer tus cambios, haz pruebas unitarias e\r\n\r\n7. Se checa de manera automática que se cumpla ciertas reglas de sintaxis. Algunas de estas reglas son necesarias para tener una sintaxis consistente en todo el repositorio. La mayoría de las reglas se pueden aplicar de manera automática corriendo el siguiente comando:\r\n    ```\r\n    dotnet format\r\n    ```\r\n    En caso de enviar tus cambios y todavía tener pendientes de sintaxis, tendrás que checar de forma manual cómo arreglarlo. Te puedes guiar de la [documentación de StyleCop](https://github.com/DotNetAnalyzers/StyleCopAnalyzers/tree/master/documentation) y pedir ayuda al equipo. Para checar de forma local la sintaxis, puedes correr el siguiente comando:\r\n\r\n    ```\r\n    dotnet format --verify-no-changes --verbosity m --severity warn\r\n    ```\r\n\r\n# Clave GPG\r\n## Requerimientos\r\n   \r\n  * El usuario debe tener instalado [Gnupg](https://www.gnupg.org/download) y [Git Bash](https://git-scm.com/downloads) para usuarios con Windows.\r\n  * El usuario debe tener instalado [Brew](https://brew.sh/index_es) para usuarios con MacBook.\r\n\r\n## Generación con MacBook\r\n\r\n1. Abre la Terminal.\r\n\r\n2. Verifica si ya tienes instalado GPG en tu Mac escribiendo el siguiente comando y presionando enter:\r\n```\r\n    gpg --version  \r\n```\r\n   *NOTA: GPG ya está instalado, verás la versión instalada y podrás continuar con el paso 4. Si no lo tienes instalado, continua con el paso 3.*\r\n\r\n3. Si no tiene GPG, el Usuario instala GPG con Homebrew.\r\n```\r\n    brew install gnupg\r\n```\r\n4. El Usuario le indica a GPG que genere una clave GPG.\r\n    * GPG solicita al Usuario la información requerida para generar la clave (nombre, dirección de correo electrónico, contraseña, etc.).\r\n    * Es muy importante que la logitud de la clave sea de: 4,096\r\n\r\n6. El Usuario ingresa la información requerida para generar sus clave gpg. \r\n   * Exportar la clave \r\n```\r\n    gpg --full-generate-key\r\n    gpg --list-secret-keys --keyid-format=long\r\n```\r\n   * Copia el ID de la clave que acabas de generar (debería tener el formato 4096R/XXXXXXXXXXXXXXXX).\r\n   * Configura Git para usar tu clave de firma ejecutando los siguientes comandos:\r\n```\r\n    git config --global user.signingkey XXXXXXXXXXXXXXXX\r\n    git config --global commit.gpgsign true\r\n```\r\n    \r\n7. Se obtiene la clave gpg en la terminal para exportarla a Github\r\n```\r\n    gpg --armor --export [key_id]\r\n```\r\n8. GPG muestra la clave generada al Usuario.\r\n\r\n9. La clave generada se guarda dentro de Github en el apartado de [GPG keys](https://github.com/settings/keys)\r\n\r\n10. Prueba que puedas firmar tus commits \r\n    * El siguiente comando mostrara tu configuración, la cual debe ser parecida a la siguiente:\r\n    \r\n```\r\n    user.signingkey=[Key]\r\n    gpg.program=gpg2\r\n    commit.gpgsign=true\r\n    git commit -S -m “[Develop] Comment”\r\n```\r\n\r\n11. En caso de no ser exitoso, ejecuta lo siguiente:\r\n\r\n```\r\n    brew install pinentry-mac\r\n    echo \"pinentry-program $(which pinentry-mac)\" >> ~/.gnupg/gpg-agent.conf\r\n    killall gpg-agent\r\n    $ if [ -r ~/.bash_profile ]; then echo 'export GPG_TTY=$(tty)' >> ~/.bash_profile; \\\r\n\r\n    else echo 'export GPG_TTY=$(tty)' >> ~/.profile; fi\r\n    \r\n    $ if [ -r ~/.zshrc ]; then echo 'export GPG_TTY=$(tty)' >> ~/.zshrc; \\\r\n\r\n   else echo 'export GPG_TTY=$(tty)' >> ~/.zprofile; fi\r\n```\r\n\r\n12. En caso de seguir con problemas seguir la siguiente secuencia:\r\n\r\n```\r\n    brew uninstall gpg\r\n    brew install gpg2\r\n    brew install pinentry-mac \r\n    gpg --full-generate-key \r\n```\r\n\r\n   * Obten la key generada: \r\n   \r\n```\r\n    gpg --list-keys\r\n```\r\n\r\nActualiza la key en local\r\n```\r\n    git config --global user.signingkey <Key de tu list>\r\n    git config --global gpg.program /usr/local/bin/gpg\r\n    git config --global commit.gpgsign true\r\n```\r\n\r\nExporta tu Key a GitHub :\r\n\r\n```\r\n    gpg --armor --export <key> \r\n```\r\n\r\nAgrega la key a GitHub desde GPG keys:   \r\n\r\nSi el error a un persiste ejecuta el siguiente comando:\r\n\r\n```\r\n    test -r ~/.bash_profile && echo 'export GPG_TTY=$(tty)' >> ~/.bash_profile\r\n    echo 'export GPG_TTY=$(tty)' >> ~/.profile\r\n```\r\n\r\n*NOTA: Si el error aun persiste:\r\n\r\n   * *Instala: https://gpgtools.org* \r\n   * *Firma la clave que utilizaste presionando \"Sign\" en la barra de menú: Key -> Sign*.\r\n\r\n## Generación con Windows\r\n\r\n1. Correr el comando para verificar si ya existe alguna clave creada.\r\n```\r\n    gpg --list-secret-keys --keyid-format=long\r\n```\r\n2. Si no existe una clave se debe generar con el siguiente comando o en caso contrario pasar al paso 4):\r\n```\r\n    gpg --full-generate-key\r\n```\r\n  * Seleccionar el tipo de llave por defecto (RSA and RSA).\r\n  * Seleccionar la longitud de bits por defecto (3072).\r\n  * Seleccionar el tiempo de expiración por defecto(0) y confirmar.\r\n  * Escribir tu nombre, correo electrónico, comentario opcional y Passhphrase y confirmarlos.\r\n\r\n4. Ejecutar el siguiente comando para visualizar la nueva llave existente:\r\n```\r\n    gpg --list-secret-keys --keyid-format=long\r\n```\r\n   * Copiar el Id de la clave: [ key_id ] \r\n   * Ejecutar el siguiente comando\r\n   \r\n```\r\n    gpg --armor --export [key_id]\r\n```\r\n   * Copiar la clave GPG, incluyendo comentarios\r\n   * Pegar la clave completa en https://github.com/settings/keys  e ingresa el título deseado\r\n   * Ejecutar el comando con el ID de la clave GPG\r\n```\r\n    git config --global user.signingkey [ key_id ]\r\n```\r\n\r\n\r\n# FAQ for developers\r\n\r\nPreguntas frecuentes etc..\r\n\r\n## Sección 1\r\n\r\n\r\n# Pull request template\r\n\r\n 1. El objetivo es agregar templates para crear pull requests de manera consistente\r\n    * Es necesario crear multiples templates, ya que los requisitios son distintos para cada branch\r\n    * Es necesario cumplir con todos los checks para poder hacer merge\r\n    * Los templates se encuentran dentro de un folder llamado PULL_REQUEST_TEMPLATE\r\n\r\n````\r\n  .github/PULL_REQUEST_TEMPLATE/develop-template.md\r\n  .github/PULL_REQUEST_TEMPLATE/main-template.md\r\n````\r\n  ![image](https://github.com/GuillermoCM2112/RedocPro/assets/131061309/6e44180b-c2e0-4f6d-a54a-0ead1fd719fe)\r\n",
    "contact": {
      "name": "test",
      "email": "someemail@somedomain.com"
    },
    "version": "1.1",
    "x-logo": {
      "url": "https://img.freepik.com/vector-premium/diseno-logotipo-agua-hexagonal-listo-usar_94202-237.jpg?w=360",
      "altText": "Your logo alt text here"
    }
  },
  "paths": {
    "/api/Auth/CancelUserAccount_1_1/CancelUserAccount": {
      "post": {
        "tags": [
          "Auth"
        ],
        "description": "Recovery an user's password, based on the requested data.",
        "operationId": "CancelUserAccount",
        "parameters": [
          {
            "name": "x-api-version",
            "in": "header",
            "required": true,
            "style": "simple",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CancelarCuenta"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "The account is close correctly.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CancelarCuentaRespuesta"
                }
              }
            }
          },
          "401": {
            "description": "- The username or password is incorrect (SPCI-401-1): incorrect data (wrong email or password).",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "- CancelUserAccount User Not Found in Auth0 (SPCI-500): error.\n- CancelUserAccount invalid grant.(SPCI-500): error.\n- Generic error from Auth0 Service.(SPCI-500): error.\n- Unhandled error, is necesary validate the log.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "CancelarCuenta": {
        "required": [
          "cancellationReason",
          "password",
          "userId"
        ],
        "type": "object",
        "properties": {
          "userId": {
            "minLength": 1,
            "type": "string",
            "description": "User identifier.",
            "example": "auth0|63b477d3b85540fe7e870500"
          },
          "password": {
            "minLength": 1,
            "type": "string",
            "description": "User password.",
            "example": "th1sIsANew%%pwd"
          },
          "cancellationReason": {
            "maxLength": 500,
            "minLength": 0,
            "type": "string",
            "description": "Reason to cancel the account."
          }
        },
        "additionalProperties": false
      },
      "CancelarCuentaRespuesta": {
        "required": [
          "successfulCancellation"
        ],
        "type": "object",
        "properties": {
          "successfulCancellation": {
            "type": "boolean",
            "description": "Property to know if the cancellation is successful."
          }
        },
        "additionalProperties": false
      },
      "Error": {
        "type": "object",
        "properties": {
          "errorCode": {
            "type": "string",
            "nullable": true
          },
          "message": {
            "type": "string",
            "nullable": true
          },
          "detail": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": false
      }
    }
  },
  "tags": [
    {
      "name": "Auth",
      "description": "Auth controller description goes here."
    },
    {
      "name": "Auth",
      "description": "Auth controller description goes here."
    }
  ]
}